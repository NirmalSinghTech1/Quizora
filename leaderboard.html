<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quizora - A Quiz app</title>

    <!-- Link CSS -->
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <main>
       <div class="leaderboard-container">
            <h1>Leaderboard</h1>
            <ol class="leaderboard-userlist">
                <!-- <li>Person 1: 400</li>
                <li>Person 2: 400</li> -->
            </ol>
            <a href="/" class="go-home-button">
                Go Home
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#3a6073"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"/></svg>
            </a>
        </div>
    </main>
    <script>
        const username = JSON.parse(sessionStorage.getItem('username'))
        const score = JSON.parse(sessionStorage.getItem('score'))
        const usersList = document.querySelector('.leaderboard-userlist')
        const usersData = JSON.parse(sessionStorage.getItem('users'))
        console.log(usersData)

        usersData.forEach( (user, index) => {
            const li = document.createElement('li')
            li.innerHTML =  `${user.username}: ${user.score}
                <svg class="delete-user-button" data-delete=${index} xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" fill="#3a6073"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/></svg>
            `
            usersList.appendChild(li)
        })

        if(usersData.length <= 0){
            usersList.innerHTML = `<li class="no-user-message">No Userdata available</li>`
        }

        function handleUserDelete(user){
            user.parentElement.remove()
            usersData.splice(user.dataset.delete, 1)
            sessionStorage.setItem('users', JSON.stringify(usersData))

            if(usersData.length <= 0){
            usersList.innerHTML = `<li class="no-user-message">No Userdata available</li>`
        }
        }

        const deleteUser = document.querySelector('.delete-user-button')
        document.addEventListener('click', (e) => {
            e.target.dataset.delete && handleUserDelete(e.target)
        })
        
    </script>
</body>
</html>