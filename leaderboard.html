<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Quizora is a free quiz app that challenges your technical skills with fun, interactive quizzes.">
    <link rel="icon" type="image/x-icon" href="./img/favicon.ico">
    <title>Quizora - A Quiz app</title>

    <!-- Link CSS -->
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <main>
       <div class="leaderboard-container">
            <h1>Leaderboard</h1>
            <ol class="leaderboard-userlist">
                <!-- Users data here render using JavaScript -->
            </ol>

            <!-- Go Home Button -->
            <a href="/" class="go-home-button" role="button">
                Go Home
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#3a6073"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"/></svg>
            </a>
        </div>
    </main>

    <!-- In-page JavaScript script -->
    <script>
        const usersList = document.querySelector('.leaderboard-userlist')

        // Getting username, score from session storage
        const username = JSON.parse(sessionStorage.getItem('username'))
        const score = JSON.parse(sessionStorage.getItem('score'))
        const usersData = JSON.parse(sessionStorage.getItem('users'))

        // Rendering username and score on leaderboard
        usersData.forEach( (user, index) => {
            const li = document.createElement('li')
            li.innerHTML =  `${user.username}: ${user.score}
                <svg class="delete-user-button" data-delete=${index} xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" fill="#3a6073"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/></svg>
            `
            usersList.appendChild(li)
        })

        // Check if no userdata available, then display message
        if(usersData.length <= 0){
            usersList.innerHTML = `<li class="no-user-message">No Userdata available</li>`
        }

        // Handle user data delete functionality
        function handleUserDelete(user){
            user.parentElement.remove()
            usersData.splice(user.dataset.delete, 1)
            sessionStorage.setItem('users', JSON.stringify(usersData))

            if(usersData.length <= 0){
            usersList.innerHTML = `<li class="no-user-message">No Userdata available</li>`
            }
        }

        // Add click event to Delete button 
        const deleteUser = document.querySelector('.delete-user-button')
        document.addEventListener('click', (e) => {
            e.target.dataset.delete && handleUserDelete(e.target)
        })
    </script>
</body>
</html>